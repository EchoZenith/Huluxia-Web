/*This code was written by PeterCoast*/$(function(){let e,i,t,d,s,l,o,a,c,n,r;""!=$_GET.post_id&&null!=$_GET.post_id||(window.location.href="../category/"),$.getJSON("../../post/detail/ANDROID/4.1.8.php",{post_id:$_GET.post_id},function(p){if(s=p.post,c=p.comments,window.totalPage=p.totalPage,window.currPageNo=p.currPageNo,e=s.voice,t=s.detail,i=s.title,d=s.images,o=s.hit,n=s.postType,a=s.commentCount,l=timestampToTime(s.updateTime),r=s.recommendTopics,t=t.replace(/<image>/g,"<img src=").replace(/<\/image>/g,">"),$(".middle").text(currPageNo+"/"+totalPage),$(".body").html(t),$(".head").html("<div>"+i+'</div><div style="font-size:10px;">'+l+'</div><div><span style="font-size:10px;">阅读：</span><span style="font-size:10px;">'+o+'</span><span style="font-size:10px;"> 评论：</span><span style="font-size:10px;">'+a+"</span></div>"),$(".commentCount").text(a),4==n||1==n){if($(".body text").each(function(){$(this).html($(this).html().replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/gi,'<a href="$1">$1</a>').replace(/\[/g,"<face>[<writeface>").replace(/\]/g,"</writeface>]</face>"))}),$(".body img").each(function(){let e=$(this).attr("src");$(this).attr("src",e.substring(0,e.indexOf(",")))}),null!=r)for(let e=0;e<r.length;e++)$(".body text").each(function(){$(this).html($(this).html().replace("&lt;","&amp;lt;").replace("&gt;","&amp;gt;").replace(r[e].title.replace("<","&amp;lt;").replace(">","&amp;gt;"),'<recommendTopics post_id="'+r[e].postID+'">'+r[e].title.replace("&amp;lt;","&lt;").replace("&amp;gt;","&gt;")+"</recommendTopics>").replace("&amp;lt;","&lt;").replace("&amp;gt;","&gt;"))})}else if((0==n||3==n)&&($(".body").each(function(){$(this).html($(this).html().replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/gi,'<a href="$1">$1</a>').replace(/\[/g,"<face>[<writeface>").replace(/\]/g,"</writeface>]</face>"))}),null!=r))for(let e=0;e<r.length;e++)$(".body").html($(".body").html().replace("&lt;","&amp;lt;").replace("&gt;","&amp;gt;").replace(r[e].title.replace("<","&amp;lt;").replace(">","&amp;gt;"),'<recommendTopics post_id="'+r[e].postID+'">'+r[e].title+"</recommendTopics>").replace("&amp;lt;","&lt;").replace("&amp;gt;","&gt;"));if($(".content").fadeToggle("slow"),$("recommendtopics").click(function(){window.location.href="../post_content/?post_id="+$(this).attr("post_id")}),""==e)for(let e=0;e<d.length;e++)$(".body").append('<img src="'+d[e]+'">');else e=JSON.parse(e),$(".video-player video").attr("src",e.videohost+e.videofid),$(".video-player video").slideDown("slow"),$(".video-player video").attr("poster",e.imghost+e.imgfid);let v,m,f,g,h,x="";$(".footer").html("");for(let e=0;e<c.length;e++)if(v=c[e].text,f=timestampToTime(c[e].createTime),g=c[e].user.nick,h=c[e].user.avatar,m=c[e].seq,d=c[e].images,refComment=c[e].refComment,v=v.replace(/\[/g,"<face>[<writeface>").replace(/\]/g,"</writeface>]</face>"),0==d.length)null==refComment?$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+h+'"></div><div style="overflow:hidden;" class="flex1"><div>'+g+'</div><div style="font-size:10px;">'+f+'</div><div style="white-space:pre-line;">'+v+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+m+"</span>楼</div></div><hr>"):$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+h+'"></div><div style="overflow:hidden;" class="flex1"><div>'+g+'</div><div style="font-size:10px;">'+f+'</div><div style="width:100%;background:#F0F0F0;padding:5px 10px;border-radius:10px"><div>回复&nbsp;'+refComment.nick+'</div><div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+refComment.text+'</div></div><div style="white-space:pre-line;">'+v+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+m+"</span>楼</div></div><hr>");else{x="";for(let e=0;e<d.length;e++)x+='<img src="'+d[e]+'">';null==refComment?$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+h+'"></div><div style="overflow:hidden;" class="flex1"><div>'+g+'</div><div style="font-size:10px;">'+f+'</div><div style="white-space:pre-line;">'+v+'</div><div style="overflow-x:scroll;" class="flex comment-img">'+x+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+m+"</span>楼</div></div><hr>"):$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+h+'"></div><div style="overflow:hidden;" class="flex1"><div>'+g+'</div><div style="font-size:10px;">'+f+'</div><div style="width:100%;background:#F0F0F0;padding:5px 10px;border-radius:10px"><div>回复&nbsp;'+refComment.nick+'</div><div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+refComment.text+'</div></div><div style="white-space:pre-line;">'+v+'</div><div style="overflow-x:scroll;" class="flex comment-img">'+x+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+m+"</span>楼</div></div><hr>")}$(".htmlLoading").slideUp("slow"),$.getJSON("../../assets/json/face.json",function(e){window.face=e,$("writeface").each(function(){for(let e=0;e<face.count;e++)if(face.text[e]==$(this).text()){$(this).parent().html("<img class='writeface' style='width:20px;' src='"+face.png[e]+"'>");break}})}),$(".comment-img img,.body img").click(function(){$("#myModal").show(),$("#img01").attr("src",$(this).attr("src"))}),$(".close,.modal-content,#myModal").click(function(){$("#myModal").hide()})})}),$(".left").click(function(){currPageNo>1&&($(".middle").text("Loading···"),$(".footer").stop().fadeToggle(),$.getJSON("../../post/detail/ANDROID/4.1.8.php",{post_id:$_GET.post_id,page_no:currPageNo-1},function(e){let i="",t="",d="",s="",l="",o="";i=e.comments,currPageNo=e.currPageNo,$(".middle").text(currPageNo+"/"+totalPage),$(".footer").html("");for(let e=0;e<i.length;e++){if(t=i[e].text,d=timestampToTime(i[e].createTime),s=i[e].user.nick,l=i[e].user.avatar,seq=i[e].seq,refComment=i[e].refComment,images=i[e].images,t=t.replace(/\[/g,"<face>[<writeface>").replace(/\]/g,"</writeface>]</face>"),0==images.length)null==refComment?$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="white-space:pre-line;">'+t+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>"):$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="width:100%;background:#F0F0F0;padding:5px 10px;border-radius:10px"><div>回复&nbsp;'+refComment.nick+'</div><div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+refComment.text+'</div></div><div style="white-space:pre-line;">'+t+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>");else{o="";for(let e=0;e<images.length;e++)o+='<img src="'+images[e]+'">';null==refComment?$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="white-space:pre-line;">'+t+'</div><div style="overflow-x:scroll;" class="flex comment-img">'+o+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>"):$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="width:100%;background:#F0F0F0;padding:5px 10px;border-radius:10px"><div>回复&nbsp;'+refComment.nick+'</div><div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+refComment.text+'</div></div><div style="white-space:pre-line;">'+t+'</div><div style="overflow-x:scroll;" class="flex comment-img">'+o+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>")}$("writeface").each(function(){for(let e=0;e<face.count;e++)if(face.text[e]==$(this).text()){$(this).parent().html("<img class='writeface' style='width:20px;' src='"+face.png[e]+"'>");break}})}$(".comment-img img").click(function(){$("#myModal").show(),$("#img01").attr("src",$(this).attr("src"))}),$(".close,.modal-content,#myModal").click(function(){$("#myModal").hide()}),$(".content").animate({scrollTop:0},0)}),$(".footer").stop().fadeToggle(),2==currPageNo&&$(".body").show())}),$(".right").click(function(){$(".body").hide(),currPageNo<totalPage&&($(".middle").text("Loading···"),$(".footer").stop().fadeToggle(),$.getJSON("../../post/detail/ANDROID/4.1.8.php",{post_id:$_GET.post_id,page_no:currPageNo+1},function(e){let i="",t="",d="",s="",l="",o="";i=e.comments,currPageNo=e.currPageNo,$(".middle").text(currPageNo+"/"+totalPage),$(".footer").html("");for(let e=0;e<i.length;e++){if(t=i[e].text,d=timestampToTime(i[e].createTime),s=i[e].user.nick,l=i[e].user.avatar,seq=i[e].seq,images=i[e].images,refComment=i[e].refComment,t=t.replace(/\[/g,"<face>[<writeface>").replace(/\]/g,"</writeface>]</face>"),0==images.length)null==refComment?$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="white-space:pre-line;">'+t+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>"):$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="width:100%;background:#F0F0F0;padding:5px 10px;border-radius:10px"><div>回复&nbsp;'+refComment.nick+'</div><div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+refComment.text+'</div></div><div style="white-space:pre-line;">'+t+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>");else{o="";for(let e=0;e<images.length;e++)o+='<img src="'+images[e]+'">';null==refComment?$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="white-space:pre-line;">'+t+'</div><div style="overflow-x:scroll;" class="flex comment-img">'+o+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>"):$(".footer").append('<div class="flex"><div><img class="comment-icon" src="'+l+'"></div><div style="overflow:hidden;" class="flex1"><div>'+s+'</div><div style="font-size:10px;">'+d+'</div><div style="width:100%;background:#F0F0F0;padding:5px 10px;border-radius:10px"><div>回复&nbsp;'+refComment.nick+'</div><div style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+refComment.text+'</div></div><div style="white-space:pre-line;">'+t+'</div><div style="overflow-x:scroll;" class="flex comment-img">'+o+'</div></div><div style="padding:10px 0;color:#008800;"><span>'+seq+"</span>楼</div></div><hr>")}$("writeface").each(function(){for(let e=0;e<face.count;e++)if(face.text[e]==$(this).text()){$(this).parent().html("<img class='writeface' style='width:20px;' src='"+face.png[e]+"'>");break}})}$(".comment-img img").click(function(){$("#myModal").show(),$("#img01").attr("src",$(this).attr("src"))}),$(".close,.modal-content,#myModal").click(function(){$("#myModal").hide()}),$(".content").animate({scrollTop:0},0)}),$(".footer").stop().fadeToggle())});